from keras.models import load_model
from keras.preprocessing.image import load_img,img_to_array
from keras.preprocessing.image import ImageDataGenerator
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
import numpy as np

model1 = load_model('./BC.h5',compile=False)

lab = {0: 'A73EGS', 1: 'Acanthopagrus Australis', 2: 'Acanthopagrus Breda', 3: 'Acanthopagrus Latus', 4: 'Achoerodus Ouldii', 5: 'Achoerodus Viridis', 6: 'Acreichthys Tomentosus', 7: 'Aesopia Cornuta', 8: 'Aethaloperca Rogaa', 9: 'Alectis Ciliaris', 10: 'Alectis Indica', 11: 'Alepes Kleinii', 12: 'Aluterus Monoceros', 13: 'Aluterus Scriptus', 14: 'Amanses Scopas', 15: 'Anampses Caeruleopunctatu', 16: 'Anampses Elegans', 17: 'Anampses Femininus', 18: 'Anampses Geographicus', 19: 'Anampses Lennardi', 20: 'Anampses Melanurus', 21: 'Anampses Meleagrrides', 22: 'Anampses Neoguinaicus', 23: 'Anampses Twistii', 24: 'Anodontostoma Chacunda', 25: 'Anyperodon Leucogrammicus', 26: 'Aphareus Furca', 27: 'Aphareus Rutilans', 28: 'Aprion Virescens', 29: 'Argyrops Spinifer', 30: 'Aseraggodes Melanstictus', 31: 'Atractoscion Aequidens', 32: 'Atule Mate', 33: 'Auxis Rochei', 34: 'Auxix Thazard', 35: 'Bathylagichthys Greyae', 36: 'Beryx Decadactylus', 37: 'Bodianus Anthioides', 38: 'Bodianus Axillaris', 39: 'Bodianus Bilunulatus', 40: 'Bodianus Bimaculatus', 41: 'Bodianus Diana', 42: 'Bodianus Loxozonus', 43: 'Bodianus Mesothorax', 44: 'Bodianus Perditio', 45: 'Bodianus Unimaculatus', 46: 'Bodianus Vulpinus', 47: 'Bothus Mancus', 48: 'Bothus Myriaster', 49: 'Bothus Panthrinus', 50: 'Brachaluteres Iacksonianus', 51: 'Brachirus Orientalis', 52: 'Caesioperca Pidopterus', 53: 'Cantherhines Dumerilii', 54: 'Cantherhines Fronticinctus', 55: 'Cantherhines Perdalis', 56: 'Cantheschenia Grandisquami', 57: 'Caprodon Longimanus', 58: 'Caprodon Schlegelii', 59: 'Carangoides Caeruleoppinat', 60: 'Carangoides Chrysophtys', 61: 'Carangoides Equula', 62: 'Carangoides Ferdau', 63: 'Carangoides Fulvoguttatus', 64: 'Carangoides Hedlandensis', 65: 'Carangoides Malabaricus', 66: 'Carangoides Orthogrammus', 67: 'Carangoides Plagiotaenia', 68: 'Caranx Ignobilis', 69: 'Caranx Lugubris', 70: 'Caranx Melampygus', 71: 'Caranx Sexfasciatus', 72: 'Carcharhinus Albimarginatus', 73: 'Carcharhinus Amblyrhynchos', 74: 'Carcharhinus Falciformis', 75: 'Carcharhinus Galapagensis', 76: 'Carcharhinus Limbatus', 77: 'Carcharhinus Melanopterus', 78: 'Carcharhinus Obscurus', 79: 'Carcharhinus Plumbeus', 80: 'Carcharhinus Sorrah', 81: 'Centroberyx Affinis', 82: 'Centrogenys Vaigiensis', 83: 'Centroscymnus Coelolepis', 84: 'Cephalopholis Argus', 85: 'Cephalopholis Boenak', 86: 'Cephalopholis Cyanostigma', 87: 'Cephalopholis Formosa', 88: 'Cephalopholis Igarashiemsis', 89: 'Cephalopholis Leopardus', 90: 'Cephalopholis Microprion', 91: 'Cephalopholis Miniata', 92: 'Cephalopholis Sexmaculata', 93: 'Cephalopholis Sonnerati', 94: 'Cephalopholis Spiloparaea', 95: 'Chascanopsetta Lugubris', 96: 'Cheilinus Chlorourus', 97: 'Cheilinus Fasciatus', 98: 'Cheilinus Oxycephalus', 99: 'Cheilinus Trilobatus', 100: 'Cheilinus Undulatus', 101: 'Cheilio Inermis', 102: 'Cheilodactylus Ephippium', 103: 'Cheilodactylus Fuscus', 104: 'Cheilodactylus Spectablis', 105: 'Cheilodactylus Vestitus', 106: 'Chelidonichthys Kumu', 107: 'Chirocentrus Dorab', 108: 'Chirocentrus Nudus', 109: 'Choerodon Anchorago', 110: 'Choerodon Cauteroma', 111: 'Choerodon Cyanodus', 112: 'Choerodon Fasciatus', 113: 'Choerodon Graphicus', 114: 'Choerodon Jordani', 115: 'Choerodon Rubescens', 116: 'Choerodon Schoenleinii', 117: 'Choerodon Venustus', 118: 'Choerodon vitta', 119: 'Choerodon Zamboangae', 120: 'Chromileptes Altivelis', 121: 'Cirrgilabrus Temminckii', 122: 'Cirrhilabrus Bathyphilus', 123: 'Cirrhilabrus Condei', 124: 'Cirrhilabrus Cyanopleura', 125: 'Cirrhilabrus Exquisitus', 126: 'Cirrhilabrus Laboutei', 127: 'Cirrhilabrus Punctatus', 128: 'Cirrhilabrus Scottorum', 129: 'Coris Aygula', 130: 'Coris Batuensis', 131: 'Coris Bulbifron', 132: 'Coris Caudimacula', 133: 'Coris Dorsomacula', 134: 'Coris Gaimard', 135: 'Coris Picta', 136: 'Coris Pictoides', 137: 'Coris Sandeyer', 138: 'Crenimugli Crenilabis', 139: 'CUNWCB', 140: 'Cymbacephalus Nematophthalmus', 141: 'Cymolutes Praetextatus', 142: 'Cymolutes Quatus', 143: 'Cynoglossus Puncticeps', 144: 'Cyttopsis Rose', 145: 'Dactylophora Nigricans', 146: 'Decapterus Macrosoma', 147: 'Decapterus Ruselli', 148: 'Diproctacanthus Xanthurus', 149: 'Dotalabrus Aurantiacus', 150: 'Elagatis Bipinnulata', 151: 'Epibulus Insidiator', 152: 'Epinephelus Areolatus', 153: 'Epinephelus Bleekeri', 154: 'Epinephelus Chlorostigma', 155: 'Epinephelus Coeruleopunctatus', 156: 'Epinephelus Coioides', 157: 'Epinephelus Corallicola', 158: 'Epinephelus Cyanopodus', 159: 'Epinephelus Epistictus', 160: 'Epinephelus Fasciatus', 161: 'Epinephelus Fuscoguttatus', 162: 'Epinephelus Hexagonatus', 163: 'Epinephelus Howlandi', 164: 'Epinephelus Lanceolatus', 165: 'Epinephelus Latifasciatus', 166: 'Epinephelus Macrospilos', 167: 'Epinephelus Maculatus', 168: 'Epinephelus Melanostigma', 169: 'Epinephelus Merra', 170: 'Epinephelus Morrhua', 171: 'Epinephelus Multinotatus', 172: 'Epinephelus Ongus', 173: 'Epinephelus Polyphekadion', 174: 'Epinephelus Quoyanus', 175: 'Epinephelus Radiatus', 176: 'Epinephelus Retouti', 177: 'Epinephelus Rivulatus', 178: 'Epinephelus Sexfasciatus', 179: 'Epinephelus Spilotoceps', 180: 'Epinephelus Tauvina', 181: 'Epinephelus Undulatostriatus', 182: 'Etelis Carbunculus', 183: 'Etelis Coruscans', 184: 'Eubalichthys Cyanoura', 185: 'Eubalichthys Moscaicus', 186: 'Eupetrichthys Angustipes', 187: 'Euthynnus affinis', 188: 'Evistias Acutirostris', 189: 'Gempylus Serpens', 190: 'Gnathanodon Speciosus', 191: 'Gnathodentex Aureolineatus', 192: 'Gracila Albomarginata', 193: 'Gymnocpranius Microdon', 194: 'Gymnocranius Audleyi', 195: 'Gymnocranius Euanus', 196: 'Gymnocranius Microdon', 197: 'Gymnoctanius Grandoculis', 198: 'Gymnosarda Unicolor', 199: 'Halichoeres Argus', 200: 'Halichoeres Biocellatus', 201: 'Halichoeres Chloropterus', 202: 'Halichoeres Chrysus', 203: 'Halichoeres Hartzfeldii', 204: 'Halichoeres Hortulanus', 205: 'Halichoeres Leucurus', 206: 'Halichoeres Margaritaceus', 207: 'Halichoeres Marginatus', 208: 'Halichoeres Melanochir', 209: 'Halichoeres Melanurus', 210: 'Halichoeres Melasmapomus', 211: 'Halichoeres Miniatus', 212: 'Halichoeres Nebulosus', 213: 'Halichoeres Nigreschens', 214: 'Halichoeres Scapularis', 215: 'Halichoeres Trimaculatus', 216: 'Harriotta releighana', 217: 'Hemigymnus Fasciatus', 218: 'Hemigymnus Melapterus', 219: 'Hemiraphus Far', 220: 'Herklotsichthys Quadrimaculatus', 221: 'Hologymnosus Annulatus', 222: 'Hologymnosus Doliatus', 223: 'Hyporhamphus Affinis', 224: 'Hyporhamphus Dussumieri', 225: 'Inegocia Japonica', 226: 'Istiophorus Platypterus', 227: 'Johnius Borneesis', 228: 'Katsuwonus Pelamis', 229: 'Labrichthys Unilineatus', 230: 'Labroides Bicolor', 231: 'Labroides Dimidiatus', 232: 'Labroides Pectoralis', 233: 'Labropsis Australis', 234: 'Labropsis Manabei', 235: 'Labropsis Xanthonota', 236: 'Latridopsis Forsteri', 237: 'Lepidocybium Flavobrunneum', 238: 'Leptojulis Cyanopleura', 239: 'Lethrinus Amboinesnsis', 240: 'Lethrinus Atkinsoni', 241: 'Lethrinus Erythracanthus', 242: 'Lethrinus Genivittatus', 243: 'Lethrinus Harak', 244: 'Lethrinus lentjan', 245: 'Lethrinus Microdon', 246: 'Lethrinus Miniatus', 247: 'Lethrinus Nebulosus', 248: 'Lethrinus Obsoletus', 249: 'Lethrinus Olivaceus', 250: 'Lethrinus Ornatus', 251: 'Lethrinus Rubrioperculatus', 252: 'Lethrinus Semicinctus', 253: 'Lethrinus Variegatus', 254: 'Lethrinus Xanthochilus', 255: 'Liopropoma Mitratum', 256: 'Liopropoma Susumi', 257: 'Liza Subviriridis', 258: 'Liza Valgiensis', 259: 'Lniistius Aneitensis', 260: 'Lniistius Pavo', 261: 'Lutjanus Adetii', 262: 'Lutjanus Argentimaculatus', 263: 'Lutjanus Biguttatus', 264: 'Lutjanus Bohar', 265: 'Lutjanus Carponotatus', 266: 'Lutjanus Decussatus', 267: 'Lutjanus Ehrenbergii', 268: 'Lutjanus Erythropterus', 269: 'Lutjanus Fulviflamma', 270: 'Lutjanus Fulvus', 271: 'Lutjanus Gibbus', 272: 'Lutjanus Johnii', 273: 'Lutjanus Kasmira', 274: 'Lutjanus Lemniscatus', 275: 'Lutjanus Lutjanus', 276: 'Lutjanus Malabaricus', 277: 'Lutjanus Monostigma', 278: 'Lutjanus Quinquelineatus', 279: 'Lutjanus Rivulatus', 280: 'Lutjanus Russellii', 281: 'Lutjanus Sebae', 282: 'Lutjanus Semicinctus', 283: 'Lutjanus Semicinctus Quoy', 284: 'Lutjanus Timoriensis', 285: 'Lutjanus Vitta', 286: 'Macolor Macularis', 287: 'Macolor Niger', 288: 'Macropharyngodon Choati', 289: 'Macropharyngodon Kuiiteri', 290: 'Macropharyngodon Meleagris', 291: 'Macropharyngodon Negrosensis', 292: 'Macropharyngodon Ornatus', 293: 'Megalaspis Cordyla', 294: 'Meuschenia Australis', 295: 'Meuschenia Freycineti', 296: 'Meuschenia Galii', 297: 'Meuschenia Hippocrepis', 298: 'Meuschenia Scaber', 299: 'Meuschenia Trachylepis', 300: 'Monacanthus Chinensis', 301: 'Monotaxis Grandoculis', 302: 'Mugim Cephalus', 303: 'Naucrates Ductor', 304: 'Negaprion Acutidens', 305: 'Nemadactylus Douglasii', 306: 'Nemadactylus Douglasii', 307: 'Nemipterus Hexodon', 308: 'Nemipterus Peronii', 309: 'Netuma Thalassine', 310: 'Nibea Soldado', 311: 'Notolabrus Fucicola', 312: 'Notolabrus Gymnogenis', 313: 'Notolabrus Tetricus', 314: 'Notorynchus Cepedianus', 315: 'Novaculichthys Taeniourus', 316: 'Novaculoides Macrolepidotus', 317: 'Oedalechilus Labiosus', 318: 'Ophthalmolepis Lineolatus', 319: 'Otolithes Ruber', 320: 'Oxycheilinus Bimaculatus', 321: 'Oxycheilinus Celebicus', 322: 'Oxycheilinus Digrammus', 323: 'Oxycheilinus Unifasciatus', 324: 'Oxymonacanthus Longirostris', 325: 'P!ROZC Z', 326: 'Pagrus Auratus', 327: 'Paracaesio Kusakarii', 328: 'Paracheilinus Filamentosus', 329: 'Paraluteres Prionurus', 330: 'Paramonacanthus Choirocephalus', 331: 'Paraplagusia Bilineata', 332: 'Parastronateus Niger', 333: 'Pardachirus Hedleyi', 334: 'Pardachirus Pavoninus', 335: 'Pentapodus Aureofasciatus', 336: 'Pentapodus Paradiseus', 337: 'Pentapodus Vitta Quoy', 338: 'Pervagor Alternans', 339: 'Pervagor Aspricaudus', 340: 'Pervagor Janthinosoma', 341: 'Pervagor Melanoceohalus', 342: 'Pervagor Nigrolineatus', 343: 'Pinjalo Lewisl', 344: 'Platycephalus Indicus', 345: 'Plectranthias Longimanus', 346: 'Plectranthias Nanus', 347: 'Plectranthias Winniensis', 348: 'Plectropomus Areolatus', 349: 'Plectropomus Laevis', 350: 'Plectropomus Leopardus', 351: 'Plectropomus Maculatus', 352: 'Plectrpomus Oligacanthus', 353: 'Plotosus Lineatus', 354: 'PQV7DP S', 355: 'Pristipomoides Argyrogrammicus', 356: 'Pristipomoides Auricilla', 357: 'Pristipomoides Filamentosus', 358: 'Pristipomoides Flavipinnis', 359: 'Pristipomoides Sieboldii', 360: 'Pristipomoides Zonatus', 361: 'Promethichthys Prometheus', 362: 'Protonibea Diacanthus', 363: 'Psettodes Erumei', 364: 'Pseudalutarius Nascicormis', 365: 'Pseudanthias Bicolor', 366: 'Pseudanthias Cooperi', 367: 'Pseudanthias Dispar', 368: 'Pseudanthias Fasciatus', 369: 'Pseudanthias Huchtii', 370: 'Pseudanthias Hypselosoma', 371: 'Pseudanthias Lori', 372: 'Pseudanthias Luzonensis', 373: 'Pseudanthias Pictilis', 374: 'Pseudanthias Pleurotaenia', 375: 'Pseudanthias Rubrizonatus', 376: 'Pseudanthias Sheni', 377: 'Pseudanthias Smithvanizi', 378: 'Pseudanthias Squamipinnis', 379: 'Pseudanthias Tuka', 380: 'Pseudanthias Ventralis', 381: 'Pseudocaranx Dentex', 382: 'Pseudocarcharias kamoharai', 383: 'Pseudocheilinus Evanidus', 384: 'Pseudocheilinus Hexataenia', 385: 'Pseudocheilinus Ocellatus', 386: 'Pseudocheilinus Octotaenia', 387: 'Pseudodax Moluccanus', 388: 'Pseudojuloides Cerasinus', 389: 'Pseudolabrus Beserialis', 390: 'Pseudolabrus Guentheri', 391: 'Pseudolabrus Luculentus', 392: 'pseudorhombus Argus', 393: 'Pseudorhombus Arsius', 394: 'Pseudorhombus Elevatus', 395: 'Pteragogus Cryptus', 396: 'Pteragogus Enneacanthus', 397: 'Pteragogus Flagellifer', 398: 'Rastrelliger Kanagurta', 399: 'Retropinna Semoni', 400: 'Rhabdosargus Sarba', 401: 'Rhincodon Typus', 402: 'Rhizoprionodon Acutus', 403: 'Ruvettus Pretiosus', 404: 'Samaris Cristatus', 405: 'Samariscus Triocellatus', 406: 'Sarda Orientalis', 407: 'Sardinella Albella', 408: 'Sardinella Gibbosa', 409: 'Sardinops Sagax', 410: 'Scaevius Milii', 411: 'Scolopsis Affinis', 412: 'Scolopsis Bilineata', 413: 'Scolopsis Lineata', 414: 'Scolopsis Margaritifer', 415: 'Scolopsis Monogramma', 416: 'Scolopsis Trilineata', 417: 'Scolopsis Vosmeri', 418: 'Scolopsis Xenochrous', 419: 'Scomberoides Commersonnianus', 420: 'Scomberoides Lysan', 421: 'Scomberomorus Commerson', 422: 'Selar Crumenophthalmus', 423: 'Selaroides Leptolepis', 424: 'Seriola Dumerili', 425: 'Seriola Hippos', 426: 'Seriola Revoliana', 427: 'Seriolina nigrofasciata', 428: 'Serranocirrhitus Latus', 429: 'Sillago Ciliata', 430: 'Sillago Sihama', 431: 'Soleichthys Heterorhinos', 432: 'Sphyraena Barracuda', 433: 'Sphyraena Forsteri', 434: 'Sphyraena Jello', 435: 'Sphyraena Obtusata', 436: 'Stegostoma Fasciatum', 437: 'Stethojulis Bandanensis', 438: 'Stethojulis Interrupta', 439: 'Stethojulis Strigiventer', 440: 'Stethojulis Trillineata', 441: 'Stolephorus Waitei', 442: 'Sueyichthys Arquatus', 443: 'Suezichthys Cyanolaemus', 444: 'Suezichthys Gracilis', 445: 'Symphoricchthys Spilurus', 446: 'Symphorus Nematophorus', 447: 'Thalassoma Amblycephalum', 448: 'Thalassoma Hardwicke', 449: 'Thalassoma Jansenii', 450: 'Thalassoma Lunare', 451: 'Thalassoma Lutescens', 452: 'Thalassoma Nigrofasciatum', 453: 'Thalassoma Purpureum', 454: 'Thalassoma Quinquevittatum', 455: 'Thalassoma Trilobatum', 456: 'Thryssa Baelama', 457: 'Thryssa Hamiltonii', 458: 'Thunnus Alalunga', 459: 'Thunnus Albacares', 460: 'Thysanophrys Celebica', 461: 'Thysanophrys Chiltonae', 462: 'Trachichthys Australis', 463: 'Trachinotus Baillonii', 464: 'Trachinotus Blochii', 465: 'Trachinotus Botla', 466: 'Trachypoma Macracanthus', 467: 'Triaenodon Obesus', 468: 'Uraspis Secunda', 469: 'Valamugil Cunnesius', 470: 'Valamugil Engeli', 471: 'Valamugil Seheli', 472: 'Variola Albimarginata', 473: 'Variola Louti', 474: 'Wattsia Mossambica', 475: 'Wetmorella Albofasciata', 476: 'Wetmorella Nigropinnata', 477: 'Xiphocheilus Typus', 478: 'Zenarchopterus Dispar', 479: 'Zeus Faber', 480: 'A73EGS', 481: 'Acanthaluteres Browni', 482: 'Acanthaluteres Spilomentarus', 483: 'Acanthaluteres Vittiger', 484: 'Acanthistius Cinctus'}
def output(location):
    img=load_img(location,target_size=(224,224,3))
    img=img_to_array(img)
    img=img/255
    img=np.expand_dims(img,[0])
    answer=model1.predict(img)
    y_class = answer.argmax(axis=-1)
    y = " ".join(str(x) for x in y_class)
    y = int(y)
    res = lab[y]
    return res

img='./dataset/valid/BLACK SWAN/1.jpg'
result = output(img)
print(result)
mat = mpimg.imread(img)
imgplot = plt.imshow(mat)
plt.show()